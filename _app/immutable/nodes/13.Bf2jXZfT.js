import{d as ve,e as S,t as A}from"../chunks/D5sV2v-t.js";import"../chunks/D8N2IpKH.js";import{ao as pe,ar as _2,as as de,v as s,A as g,g as e,aw as t,au as l,av as o,ay as z,ak as J,az as $2,aG as q}from"../chunks/KsHbyUNR.js";import{e as M,s as q2}from"../chunks/-k1GO34d.js";import{i as X}from"../chunks/CtV-pIfB.js";import{e as g2,i as h2}from"../chunks/DoBij9eO.js";import{r as x,s as b,b as ue}from"../chunks/BPQtVfJb.js";import{b as R,c as U2}from"../chunks/DOAI4MeL.js";import{b as I2}from"../chunks/BbN16xX5.js";import{p as me}from"../chunks/CWmzcjye.js";import{i as fe}from"../chunks/BAI0Ud4A.js";import{o as _e}from"../chunks/Cn8aehMD.js";import{g as Y}from"../chunks/BvjJfwgW.js";import{g as w2}from"../chunks/Bik8MNGL.js";import{a as U}from"../chunks/1h2pWYcr.js";import{s as k2}from"../chunks/C1lBQpt0.js";import{m as ge,t as he}from"../chunks/DkNEb3wR.js";import{h as b2}from"../chunks/CPRV9u04.js";const Xe=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),we="data:image/svg+xml,%3csvg%20style='height:%20512px;%20width:%20512px;'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20d='M0%200h512v512H0z'%20fill='%23d6e010'%20fill-opacity='0'%3e%3c/path%3e%3cg%20class=''%20style=''%20transform='translate(0,0)'%3e%3cpath%20d='M143.627%2036.361c-2.18%200-16.495%2038.303-18.258%2039.584-1.763%201.281-42.615%203.06-43.289%205.133-.673%202.073%2031.33%2027.523%2032.004%2029.596.674%202.073-10.26%2041.475-8.496%2042.756%201.763%201.28%2035.86-21.291%2038.039-21.291%202.18%200%2036.276%2022.572%2038.039%2021.29%201.763-1.28-9.17-40.682-8.496-42.755.673-2.073%2032.677-27.523%2032.004-29.596-.674-2.073-41.526-3.852-43.29-5.133-1.763-1.28-16.077-39.584-18.257-39.584zm224.746%200c-2.18%200-16.494%2038.303-18.258%2039.584-1.763%201.281-42.615%203.06-43.289%205.133-.673%202.073%2031.33%2027.523%2032.004%2029.596.674%202.073-10.26%2041.475-8.496%2042.756%201.763%201.28%2035.86-21.291%2038.039-21.291%202.18%200%2036.276%2022.572%2038.04%2021.29%201.762-1.28-9.17-40.682-8.497-42.755.674-2.073%2032.677-27.523%2032.004-29.596-.674-2.073-41.526-3.852-43.29-5.133-1.762-1.28-16.077-39.584-18.257-39.584zM256%2039.883c-7.12%200-53.884%20125.123-59.645%20129.308-5.76%204.185-139.211%209.996-141.412%2016.768-2.2%206.772%20102.349%2089.912%20104.55%2096.684%202.2%206.771-33.513%20135.486-27.753%20139.671C137.5%20426.5%20248.88%20352.76%20256%20352.76c7.12%200%20118.5%2073.74%20124.26%2069.554%205.76-4.185-29.952-132.9-27.752-139.671%202.2-6.772%20106.749-89.912%20104.549-96.684-2.2-6.772-135.652-12.583-141.412-16.768-5.76-4.185-52.525-129.308-59.645-129.308zM77.973%20243.102c-2.18%200-16.495%2038.302-18.258%2039.584-1.763%201.28-42.616%203.06-43.29%205.132-.673%202.073%2031.333%2027.523%2032.007%2029.596.673%202.073-10.26%2041.475-8.496%2042.756%201.763%201.281%2035.857-21.291%2038.037-21.291%202.18%200%2036.275%2022.572%2038.039%2021.29%201.763-1.28-9.17-40.682-8.496-42.755.673-2.073%2032.679-27.523%2032.005-29.596-.673-2.073-41.525-3.851-43.289-5.132-1.763-1.282-16.08-39.584-18.26-39.584zm356.054%200c-2.18%200-16.496%2038.302-18.26%2039.584-1.763%201.28-42.615%203.06-43.288%205.132-.674%202.073%2031.332%2027.523%2032.005%2029.596.674%202.073-10.26%2041.475-8.496%2042.756%201.764%201.281%2035.86-21.291%2038.04-21.291%202.179%200%2036.273%2022.572%2038.036%2021.29%201.764-1.28-9.17-40.682-8.496-42.755.674-2.073%2032.68-27.523%2032.006-29.596-.673-2.073-41.526-3.851-43.289-5.132-1.763-1.282-16.078-39.584-18.258-39.584zM256%20369.932c-2.18%200-16.494%2038.302-18.258%2039.584-1.763%201.28-42.615%203.06-43.289%205.132-.673%202.073%2031.33%2027.525%2032.004%2029.598.674%202.073-10.26%2041.475-8.496%2042.756%201.763%201.281%2035.86-21.293%2038.039-21.293%202.18%200%2036.276%2022.574%2038.04%2021.293%201.762-1.281-9.17-40.683-8.497-42.756.673-2.073%2032.677-27.525%2032.004-29.598-.674-2.072-41.526-3.851-43.29-5.132-1.763-1.282-16.077-39.584-18.257-39.584z'%20fill='%23ff7a20'%20fill-opacity='1'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",j2="data:image/svg+xml,%3csvg%20style='height:%20512px;%20width:%20512px;'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20d='M0%200h512v512H0z'%20fill='%23d6e010'%20fill-opacity='0'%3e%3c/path%3e%3cg%20class=''%20style=''%20transform='translate(0,0)'%3e%3cpath%20d='M372.48%2031.215c-77.65%200-116.48%2065.73-116.48%2065.73s-38.83-65.72-116.48-65.72c-37.14%200-107.77%2033.72-107.77%20125.13%200%20161.24%20224.25%20324.43%20224.25%20324.43s224.25-163.19%20224.25-324.43c0-91.42-70.63-125.13-107.77-125.14zM146.924%20225.65h220v60.7h-220z'%20fill='rgb(250,%2044,%20202)'%20fill-opacity='1'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",ke="data:image/svg+xml,%3csvg%20style='height:%20512px;%20width:%20512px;'%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20d='M0%200h512v512H0z'%20fill='%23d6e010'%20fill-opacity='0'%3e%3c/path%3e%3cg%20class=''%20style=''%20transform='translate(0,0)'%3e%3cpath%20d='M64%2048c-8.726%200-16%207.274-16%2016v384c0%208.726%207.274%2016%2016%2016h215v-16H64V64h63.375v97.53c0%203.924%203.443%207.095%207.72%207.095h169.81c4.277%200%207.72-3.17%207.72-7.094V64h69.22c.428.318.8.548%201.467%201.094%202.05%201.675%204.962%204.264%208.375%207.406%206.827%206.283%2015.65%2014.837%2024.313%2023.5%208.663%208.663%2017.217%2017.486%2023.5%2024.313%203.142%203.413%205.73%206.324%207.406%208.374.546.668.776%201.04%201.094%201.47V330.25l16%2016V128c0-2.68-.657-3.402-1.03-4.156a15.312%2015.312%200%200%200-1.095-1.844c-.74-1.1-1.575-2.19-2.594-3.438-2.036-2.492-4.768-5.55-8.03-9.093-6.524-7.09-15.155-16-23.938-24.782-8.782-8.783-17.692-17.414-24.78-23.938-3.545-3.262-6.6-5.994-9.094-8.03-1.247-1.02-2.337-1.855-3.438-2.595-.55-.37-1.09-.72-1.844-1.094-.754-.373-1.477-1.03-4.156-1.03H64zm87.72%2016h48.56c4.277%200%207.72%204.425%207.72%209.938v70.124c0%205.513-3.443%209.938-7.72%209.938h-48.56c-4.277%200-7.72-4.425-7.72-9.938V73.938c0-5.512%203.443-9.937%207.72-9.937zM114%20212c-4.432%200-8%203.568-8%208v184c0%204.432%203.568%208%208%208h165v-28h-76.72l15.345-15.375%20128-128L352%20234.28l6.375%206.345L406%20288.25V220c0-4.432-3.568-8-8-8H114zm238%2047.75L245.75%20366H297v128h110V366h51.25L352%20259.75zM448%20384v64h-23v16h23c8.726%200%2016-7.274%2016-16v-64h-16z'%20fill='%23000000'%20fill-opacity='1'%3e%3c/path%3e%3c/g%3e%3c/svg%3e";var be=A("<p>Loading profile…</p>"),je=A('<div class="error-banner svelte-cjs9wk"> </div>'),ye=A('<progress class="progress-bar svelte-cjs9wk" max="100"></progress> <p> </p>',1),Se=A('<div class="field svelte-cjs9wk"><label for="stance" class="svelte-cjs9wk">Stance</label> <select id="stance" class="svelte-cjs9wk"><option>Regular</option><option>Goofy</option></select></div>'),xe=A('<div class="list-row svelte-cjs9wk"><input type="url" placeholder="https://" required class="svelte-cjs9wk"> <button type="button" class="svelte-cjs9wk"><img alt="Remove" class="svelte-cjs9wk"></button></div>'),ze=A('<div class="list-row svelte-cjs9wk"><input placeholder="Sponsor name" required class="svelte-cjs9wk"> <button type="button" class="svelte-cjs9wk"><img alt="Remove" class="svelte-cjs9wk"></button></div>'),Ae=A('<div class="contest-header svelte-cjs9wk"><span>Name</span> <span>Division</span> <span>Date</span> <span>Placement</span> <span></span></div>'),Me=A('<div class="contest-row svelte-cjs9wk"><input class="contest-name svelte-cjs9wk" placeholder="Contest name" required> <input class="contest-division svelte-cjs9wk" placeholder="Division"> <input class="contest-date svelte-cjs9wk" type="date"> <input class="contest-placement svelte-cjs9wk" type="number" min="1"> <button type="button" class="remove-btn svelte-cjs9wk"><img alt="Remove" class="svelte-cjs9wk"></button></div>'),Re=A('<!> <div class="container svelte-cjs9wk"><h1 class="svelte-cjs9wk">Edit Your Profile</h1> <div class="avatar-section svelte-cjs9wk"><img alt="Avatar preview" class="avatar-img svelte-cjs9wk"> <input type="file" accept="image/*" class="svelte-cjs9wk"> <!></div> <form><div class="field svelte-cjs9wk"><label for="name" class="svelte-cjs9wk">Name</label> <input id="name" required class="svelte-cjs9wk"></div> <div class="field svelte-cjs9wk"><label for="hometown" class="svelte-cjs9wk">Location</label> <input id="hometown" class="svelte-cjs9wk"></div> <div class="field-group svelte-cjs9wk"><label class="svelte-cjs9wk"><input type="checkbox" class="svelte-cjs9wk"> Skateboarder</label> <label class="svelte-cjs9wk"><input type="checkbox" class="svelte-cjs9wk"> Roller Skater</label></div> <!> <div class="field svelte-cjs9wk"><label for="status" class="svelte-cjs9wk">Skill Level</label> <select id="status" class="svelte-cjs9wk"><option>Amateur</option><option>Pro</option></select></div> <section class="svelte-cjs9wk"><h2 class="svelte-cjs9wk"><img width="32" height="32" alt="Social" class="svelte-cjs9wk"> Social Links</h2> <!> <button type="button" class="svelte-cjs9wk"><img alt="Add social media account" class="svelte-cjs9wk"> <span class="svelte-cjs9wk">Add Social Link</span></button></section> <section class="svelte-cjs9wk"><h2 class="svelte-cjs9wk"><img width="32" height="32" alt="Sponsors" class="svelte-cjs9wk"> Sponsors</h2> <!> <button type="button" class="svelte-cjs9wk"><img alt="Add sponsor" class="svelte-cjs9wk"> <span class="svelte-cjs9wk">Add Sponsor</span></button></section> <section class="svelte-cjs9wk"><h2 class="svelte-cjs9wk"><img width="32" height="32" alt="Contest Results" class="svelte-cjs9wk"> Contest Results</h2> <!> <!> <button type="button" class="svelte-cjs9wk"><img alt="Add result" class="svelte-cjs9wk"> <span class="svelte-cjs9wk">Add Result</span></button></section> <hr class="svelte-cjs9wk"> <button type="submit" class="svelte-cjs9wk"><img alt="Save profile" class="svelte-cjs9wk"> <span class="svelte-cjs9wk">Save Profile</span></button></form></div>',1);function Ye(V2,N2){pe(N2,!1);let I=g(""),T="",j=g(""),V=g(""),D=g(!1),N=g(!1),O=g("regular"),$=g("amateur"),w=g([]),i=g([]),k=g([]),F=g(null),B=g(!1),K=g(0),y2=g(!0),L=g(null);_e(async()=>{const r=Y(k2);s(I,r.name||""),s(V,r.hometown||""),s(D,r.is_skateboarder||!1),s(N,r.is_rollerskater||!1),s(O,r.stance||"regular"),s($,(r.status||"amateur").toLowerCase()),s(w,(r.sponsors||[]).map(v=>v.brand||v)),s(i,r.contest_results||[]),s(k,r.social_urls||[]),T=r.image||"",s(j,r.image_small||""),s(F,e(j));const{username:u,token:m}=Y(U);if(!u||!m){w2("/login");return}try{const v=await fetch(`https://3ee.dev/skatebuild/api/profiles/${encodeURIComponent(u)}/`,{headers:{Accept:"application/json",Authorization:`Token ${m}`}});if(v.ok){const n=await v.json();s(I,n.name),s(V,n.hometown),s(D,n.is_skateboarder),s(N,n.is_rollerskater),s(O,n.stance||"regular"),s($,(n.status||"amateur").toLowerCase()),s(w,(n.sponsors||[]).map(p=>p.brand)),s(i,n.contest_results||[]),s(k,n.social_urls||[]),T=n.image,s(j,n.image_small),s(F,e(j))}}catch(v){console.error("Failed to load profile from API, using draft:",v)}finally{s(y2,!1)}});async function F2(r){var E;const u=r.currentTarget;if(!((E=u.files)!=null&&E[0]))return;const m=u.files[0];s(F,URL.createObjectURL(m)),s(B,!0),s(K,0);const{token:v}=Y(U),n=new FormData;n.append("file",m),n.append("useDiffusion","false");const p=new XMLHttpRequest;p.open("POST","https://3ee.dev/account/upload/",!0),p.setRequestHeader("Accept","application/json"),p.setRequestHeader("Access-Control-Allow-Origin","https://skatebuild.pro"),p.setRequestHeader("Authorization",`Token ${v}`),p.upload.onprogress=y=>{y.lengthComputable&&s(K,Math.round(y.loaded/y.total*100))},p.onload=()=>{if(s(B,!1),p.status===401){U.set({}),w2("/login");return}if(p.status>=200&&p.status<300){const y=JSON.parse(p.responseText);T=y.image,s(j,y.imageSmall),s(F,e(j));const G={...Y(U)};G.profile={...G.profile,image:T,imageSmall:e(j)},U.set(G),k2.update(Q=>({...Q,image:T,image_small:e(j)}))}else console.error("Upload failed:",p.statusText),s(L,"Image upload failed")},p.onerror=()=>{s(B,!1),console.error("Upload XHR error"),s(L,"Image upload failed")},p.send(n)}function B2(){s(w,[...e(w),""])}function E2(r){s(w,e(w).filter((u,m)=>m!==r))}function G2(){s(i,[...e(i),{name:"",division:"",date:new Date().toISOString().slice(0,10),placement:1}])}function J2(r){s(i,e(i).filter((u,m)=>m!==r))}function X2(){s(k,[...e(k),""])}function Y2(r){s(k,e(k).filter((u,m)=>m!==r))}async function K2(){s(L,null);const{username:r,token:u}=Y(U);if(!r||!u){s(L,"Not authenticated");return}const m={name:e(I),hometown:e(V),is_skateboarder:e(D),is_rollerskater:e(N),stance:e(O),status:e($),sponsors:e(w).map(v=>({brand:v})),contest_results:e(i),image:T,image_small:e(j),social_urls:e(k)};try{const v=await fetch("https://3ee.dev/skatebuild/api/profiles/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Token ${u}`},body:JSON.stringify(m)}),n=await v.json();if(!v.ok)throw new Error(n.detail||"Save failed");k2.set(n),await w2(`/profiles/${r}`)}catch(v){console.error(v),s(L,v.message)}}fe();var S2=ve(),Q2=_2(S2);{var W2=r=>{var u=be();S(r,u)},Z2=r=>{var u=Re(),m=_2(u);{var v=a=>{var _=je(),c=l(_,!0);o(_),J(()=>q2(c,e(L))),S(a,_)};X(m,a=>{e(L)&&a(v)})}var n=t(m,2),p=t(l(n),2),E=l(p),y=t(E,2),G=t(y,2);{var Q=a=>{var _=ye(),c=_2(_),d=t(c,2),f=l(d);o(d),J(()=>{ue(c,e(K)),q2(f,`Uploading… ${e(K)??""}%`)}),S(a,_)};X(G,a=>{e(B)&&a(Q)})}o(p);var W=t(p,2),Z=l(W),x2=t(l(Z),2);x(x2),o(Z);var e2=t(Z,2),z2=t(l(e2),2);x(z2),o(e2);var s2=t(e2,2),t2=l(s2),A2=l(t2);x(A2),z(),o(t2);var M2=t(t2,2),R2=l(M2);x(R2),z(),o(M2),o(s2);var L2=t(s2,2);{var ee=a=>{var _=Se(),c=t(l(_),2);J(()=>{e(O),$2(()=>{})});var d=l(c);d.value=d.__value="regular";var f=t(d);f.value=f.__value="goofy",o(c),o(_),I2(c,()=>e(O),h=>s(O,h)),S(a,_)};X(L2,a=>{e(D)&&a(ee)})}var a2=t(L2,2),l2=t(l(a2),2);J(()=>{e($),$2(()=>{})});var o2=l(l2);o2.value=o2.__value="amateur";var C2=t(o2);C2.value=C2.__value="pro",o(l2),o(a2);var r2=t(a2,2),c2=l(r2),se=l(c2);b(se,"src",we),z(),o(c2);var H2=t(c2,2);g2(H2,1,()=>e(k),h2,(a,_,c)=>{var d=xe(),f=l(d);x(f);var h=t(f,2),C=l(h);b(C,"src",j2),o(h),o(d),R(f,()=>e(k)[c].url,H=>q(k,e(k)[c].url=H)),M("click",h,()=>Y2(c)),S(a,d)});var i2=t(H2,2),te=l(i2);b(te,"src",b2),z(2),o(i2),o(r2);var n2=t(r2,2),v2=l(n2),ae=l(v2);b(ae,"src",ge),z(),o(v2);var P2=t(v2,2);g2(P2,1,()=>e(w),h2,(a,_,c)=>{var d=ze(),f=l(d);x(f);var h=t(f,2),C=l(h);b(C,"src",j2),o(h),o(d),R(f,()=>e(w)[c],H=>q(w,e(w)[c]=H)),M("click",h,()=>E2(c)),S(a,d)});var p2=t(P2,2),le=l(p2);b(le,"src",b2),z(2),o(p2),o(n2);var d2=t(n2,2),u2=l(d2),oe=l(u2);b(oe,"src",he),z(),o(u2);var T2=t(u2,2);{var re=a=>{var _=Ae();S(a,_)};X(T2,a=>{e(i).length&&a(re)})}var D2=t(T2,2);g2(D2,1,()=>e(i),h2,(a,_,c)=>{var d=Me(),f=l(d);x(f);var h=t(f,2);x(h);var C=t(h,2);x(C);var H=t(C,2);x(H);var f2=t(H,2),ne=l(f2);b(ne,"src",j2),o(f2),o(d),R(f,()=>e(i)[c].name,P=>q(i,e(i)[c].name=P)),R(h,()=>e(i)[c].division,P=>q(i,e(i)[c].division=P)),R(C,()=>e(i)[c].date,P=>q(i,e(i)[c].date=P)),R(H,()=>e(i)[c].placement,P=>q(i,e(i)[c].placement=P)),M("click",f2,()=>J2(c)),S(a,d)});var m2=t(D2,2),ce=l(m2);b(ce,"src",b2),z(2),o(m2),o(d2);var O2=t(d2,4),ie=l(O2);b(ie,"src",ke),z(2),o(O2),o(W),o(n),J(()=>{b(E,"src",e(F)||e(j)||"/default-avatar.png"),y.disabled=e(B)}),M("change",y,F2),R(x2,()=>e(I),a=>s(I,a)),R(z2,()=>e(V),a=>s(V,a)),U2(A2,()=>e(D),a=>s(D,a)),U2(R2,()=>e(N),a=>s(N,a)),I2(l2,()=>e($),a=>s($,a)),M("click",i2,X2),M("click",p2,B2),M("click",m2,G2),M("submit",W,me(K2)),S(r,u)};X(Q2,r=>{e(y2)?r(W2):r(Z2,!1)})}S(V2,S2),de()}export{Ye as component,Xe as universal};
