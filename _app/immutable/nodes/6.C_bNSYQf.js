import{t as D,e as L,h as _t}from"../chunks/D5sV2v-t.js";import"../chunks/D8N2IpKH.js";import{ao as Ee,ap as be,aq as mt,ak as _e,g as a,as as Re,au as f,aw as l,v as c,A as $,j as ce,av as v,n as Ve,az as bt,ay as pt,ar as fe,ax as jt}from"../chunks/KsHbyUNR.js";import{i as Le}from"../chunks/BAI0Ud4A.js";import{p as r,s as yt}from"../chunks/DZQkes7P.js";import{o as De,a as ht}from"../chunks/Cn8aehMD.js";import{g as kt}from"../chunks/BvjJfwgW.js";import{e as ee,s as et}from"../chunks/-k1GO34d.js";import{i as se}from"../chunks/CtV-pIfB.js";import{e as Ae,i as Xe}from"../chunks/DoBij9eO.js";import{r as ge,s as St}from"../chunks/BPQtVfJb.js";import{b as pe,a as It}from"../chunks/DOAI4MeL.js";import{b as wt}from"../chunks/BbN16xX5.js";import{b as Ce}from"../chunks/CUj6M3NL.js";import{s as Ye}from"../chunks/ZoJKLrrX.js";import{a as Tt}from"../chunks/1h2pWYcr.js";import{g as xt}from"../chunks/Bik8MNGL.js";const Nt=!1,Pa=Object.freeze(Object.defineProperty({__proto__:null,prerender:Nt},Symbol.toStringTag,{value:"Module"}));var Ot=typeof global=="object"&&global&&global.Object===Object&&global,Ct=typeof self=="object"&&self&&self.Object===Object&&self,tt=Ot||Ct||Function("return this")(),je=tt.Symbol,at=Object.prototype,Bt=at.hasOwnProperty,At=at.toString,ve=je?je.toStringTag:void 0;function Pt(t){var e=Bt.call(t,ve),g=t[ve];try{t[ve]=void 0;var p=!0}catch{}var j=At.call(t);return p&&(e?t[ve]=g:delete t[ve]),j}var Et=Object.prototype,Rt=Et.toString;function Lt(t){return Rt.call(t)}var Dt="[object Null]",Ft="[object Undefined]",Qe=je?je.toStringTag:void 0;function Mt(t){return t==null?t===void 0?Ft:Dt:Qe&&Qe in Object(t)?Pt(t):Lt(t)}function qt(t){return t!=null&&typeof t=="object"}var Wt="[object Symbol]";function Ut(t){return typeof t=="symbol"||qt(t)&&Mt(t)==Wt}var zt=/\s/;function Gt(t){for(var e=t.length;e--&&zt.test(t.charAt(e)););return e}var Ht=/^\s+/;function Jt(t){return t&&t.slice(0,Gt(t)+1).replace(Ht,"")}function Pe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ze=NaN,Kt=/^[-+]0x[0-9a-f]+$/i,Vt=/^0b[01]+$/i,Xt=/^0o[0-7]+$/i,Yt=parseInt;function $e(t){if(typeof t=="number")return t;if(Ut(t))return Ze;if(Pe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Pe(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Jt(t);var g=Vt.test(t);return g||Xt.test(t)?Yt(t.slice(2),g?2:8):Kt.test(t)?Ze:+t}var Be=function(){return tt.Date.now()},Qt="Expected a function",Zt=Math.max,$t=Math.min;function ea(t,e,g){var p,j,F,h,_,m,A=0,M=!1,k=!1,N=!0;if(typeof t!="function")throw new TypeError(Qt);e=$e(e)||0,Pe(g)&&(M=!!g.leading,k="maxWait"in g,F=k?Zt($e(g.maxWait)||0,e):F,N="trailing"in g?!!g.trailing:N);function P(u){var E=p,J=j;return p=j=void 0,A=u,h=t.apply(J,E),h}function G(u){return A=u,_=setTimeout(Q,e),M?P(u):h}function H(u){var E=u-m,J=u-A,Z=e-E;return k?$t(Z,F-J):Z}function O(u){var E=u-m,J=u-A;return m===void 0||E>=e||E<0||k&&J>=F}function Q(){var u=Be();if(O(u))return le(u);_=setTimeout(Q,H(u))}function le(u){return _=void 0,N&&p?P(u):(p=j=void 0,h)}function o(){_!==void 0&&clearTimeout(_),A=0,p=m=j=_=void 0}function T(){return _===void 0?h:le(Be())}function te(){var u=Be(),E=O(u);if(p=arguments,j=this,m=u,E){if(_===void 0)return G(m);if(k)return clearTimeout(_),_=setTimeout(Q,e),P(m)}return _===void 0&&(_=setTimeout(Q,e)),h}return te.cancel=o,te.flush=T,te}var ta=D('<li role="option" tabindex="0" class="svelte-jm6a8l"> </li>'),aa=D('<li class="loading svelte-jm6a8l">Loading more...</li>'),la=D('<li style="height: 50px;" class="svelte-jm6a8l"></li>'),ra=D('<ul role="listbox" class="svelte-jm6a8l"><!> <!> <!></ul>'),ia=D('<div class="combobox svelte-jm6a8l"><input autocomplete="off" class="svelte-jm6a8l"> <!></div>');function z(t,e){Ee(e,!1);let g=r(e,"category",8),p=r(e,"type",8),j=r(e,"value",12,""),F=r(e,"valueId",12,""),h=r(e,"initialName",8,""),_=r(e,"placeholder",8,"Start typing…"),m=$(""),A=$(!1),M=$(),k=$([]),N=$(null),P=$(!1),G=$(),H=$(),O=$(null);const Q=async s=>{c(P,!0);const S=await fetch(s);if(S.ok){const C=await S.json(),W=C.results.map(U=>({slug:U.slug,id:U.id,productName:U.name})),K=new Set(a(k).map(U=>U.slug)),re=W.filter(U=>!K.has(U.slug));c(k,[...a(k),...re]),K.clear(),c(N,C.next)}else console.error("Fetch failed:",S.status,await S.text());c(P,!1)},le=()=>{c(k,[]),c(N,null);const s=`https://3ee.dev/skatebuild/api/products/?category=${g()}&type=${p()}`;Q(s)},o=()=>{a(N)&&!a(P)?Q(a(N)):console.log("Cannot load more: nextPage=",a(N),"isLoading=",a(P))},T=ea(s=>{c(k,[]),c(N,null);const S=`https://3ee.dev/skatebuild/api/products/?search=${s}&category=${g()}&type=${p()}`;Q(S)},300);function te(s){c(m,s.target.value),c(A,!0),T(a(m))}function u(s){c(m,s.productName),j(s.slug),F(s.id),c(A,!1),a(M).focus()}async function E(s){if(!s)return;const S=`https://3ee.dev/skatebuild/api/products/?slug=${s}&category=${g()}&type=${p()}`,C=await fetch(S);if(C.ok){const W=await C.json();if(W.results.length>0){const K=W.results[0];c(m,K.name),F(K.id)}else console.warn(`No product found for slug ${s}`)}else console.error("Fetch product failed:",C.status,await C.text())}const J=()=>{if(a(H)&&a(N)&&!a(P)){const{scrollTop:s,scrollHeight:S,clientHeight:C}=a(H);s+C>=S-20&&o()}};De(()=>{j()&&h()?c(m,h()):j()&&E(j())}),ht(()=>{a(O)&&a(G)&&(a(O).unobserve(a(G)),c(O,null))}),be(()=>(ce(g()),ce(p())),()=>{(g()||p())&&le()}),be(()=>(ce(j()),ce(h()),a(k)),()=>{j()&&!h()&&!a(k).find(s=>s.slug===j())&&E(j())}),be(()=>ce(h()),()=>{h()&&c(m,h())}),be(()=>(a(G),a(H),a(O),a(N),a(P)),()=>{a(G)&&a(H)?(a(O)&&a(O).disconnect(),c(O,new IntersectionObserver(s=>{s[0].isIntersecting&&a(N)&&!a(P)&&o()},{root:a(H),threshold:.5,rootMargin:"20px"})),a(O).observe(a(G))):a(O)&&(a(O).disconnect(),c(O,null))}),mt(),Le();var Z=ia(),q=f(Z);ge(q),Ce(q,s=>c(M,s),()=>a(M));var ne=l(q,2);{var oe=s=>{var S=ra(),C=f(S);Ae(C,1,()=>a(k),B=>B.slug,(B,V)=>{var X=ta(),ue=f(X,!0);v(X),_e(()=>et(ue,a(V).productName)),ee("mousedown",X,Y=>{Y.preventDefault(),u(a(V))}),ee("keydown",X,Y=>{var ie,de;Y.key==="Enter"?u(a(V)):Y.key==="ArrowDown"?(ie=Y.currentTarget.nextElementSibling)==null||ie.focus():Y.key==="ArrowUp"&&((de=Y.currentTarget.previousElementSibling)==null||de.focus())}),L(B,X)});var W=l(C,2);{var K=B=>{var V=aa();L(B,V)};se(W,B=>{a(P)&&B(K)})}var re=l(W,2);{var U=B=>{var V=la();Ce(V,X=>c(G,X),()=>a(G)),L(B,V)};se(re,B=>{a(N)&&!a(P)&&B(U)})}v(S),Ce(S,B=>c(H,B),()=>a(H)),ee("scroll",S,J),L(s,S)};se(ne,s=>{a(A)&&s(oe)})}v(Z),_e(()=>St(q,"placeholder",_())),pe(q,()=>a(m),s=>c(m,s)),ee("input",q,te),ee("focus",q,()=>c(A,!0)),ee("blur",q,()=>setTimeout(()=>c(A,!1),150)),L(t,Z),Re()}var sa=D('<label class="svelte-1mjfju1"><input type="radio" required class="svelte-1mjfju1"> </label>'),na=D("<option>Street</option> <option>Vert</option> <option>Freestyle</option> <option>Park</option> <option>Downhill</option> <option>Cruisin</option>",1),oa=D("<option>Artistic skating</option> <option>Roller dance</option> <option>Speed skating</option> <option>Roller derby</option> <option>Park skating</option> <option>Roller hockey</option>",1),ua=D('<div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Deck</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Griptape</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Rails</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Risers</label> <!></div>',1),da=D('<div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Boot</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Toestops</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Slideblocks</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Plates</label> <!></div>',1),ca=D('<div class="attribute-row svelte-1mjfju1"><input type="text" placeholder="Name" required class="svelte-1mjfju1"> <input class="attribute-slider svelte-1mjfju1" type="range" min="0" max="1" step="0.01"> <button class="removeBtn svelte-1mjfju1" type="button">✕</button></div>'),va=D('<form class="container svelte-1mjfju1"><div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Build Name</label> <input required class="svelte-1mjfju1"></div> <div class="field-group svelte-1mjfju1"></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Style</label> <select required class="svelte-1mjfju1"><option disabled>Select style</option><!></select></div> <!> <!> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Trucks</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Bearings</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Wheels</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Bushings</label> <!></div> <div class="field svelte-1mjfju1"><label class="svelte-1mjfju1">Stats (max 5)</label> <!> <button type="button" class="add-attr-btn svelte-1mjfju1">+ Add Stat</button></div> <button type="submit" class="svelte-1mjfju1"><span>Save Build</span></button></form>');function fa(t,e){Ee(e,!1);const g=[];let p=r(e,"name",12,""),j=r(e,"slug",8,""),F=r(e,"skater_type",24,()=>[]),h=r(e,"skating_type",12,""),_=r(e,"deck_name",8,""),m=r(e,"griptape_name",8,""),A=r(e,"risers_name",8,""),M=r(e,"rails_name",8,""),k=r(e,"boot_name",8,""),N=r(e,"toestops_name",8,""),P=r(e,"slideblock_name",8,""),G=r(e,"plates_name",8,""),H=r(e,"trucks_name",8,""),O=r(e,"bearings_name",8,""),Q=r(e,"wheels_name",8,""),le=r(e,"bushings_name",8,""),o=r(e,"build_type",12,""),T=r(e,"attributes",28,()=>[]),te=r(e,"submit",8),u=r(e,"deck_id",12,""),E=r(e,"griptape_id",12,""),J=r(e,"rails_id",12,""),Z=r(e,"risers_id",12,""),q=r(e,"boot_id",12,""),ne=r(e,"toestops_id",12,""),oe=r(e,"slideblock_id",12,""),s=r(e,"plates_id",12,""),S=r(e,"trucks_id",12,""),C=r(e,"bearings_id",12,""),W=r(e,"wheels_id",12,""),K=r(e,"bushings_id",12,""),re=r(e,"deck_slug",12,""),U=r(e,"griptape_slug",12,""),B=r(e,"rails_slug",12,""),V=r(e,"risers_slug",12,""),X=r(e,"boot_slug",12,""),ue=r(e,"toestops_slug",12,""),Y=r(e,"slideblock_slug",12,""),ie=r(e,"plates_slug",12,""),de=r(e,"trucks_slug",12,""),Fe=r(e,"bearings_slug",12,""),Me=r(e,"wheels_slug",12,""),qe=r(e,"bushings_slug",12,"");console.log("FUCK",p()),p(),j();const lt=["skateboard","rollerskate"];De(()=>{const i=X()||ue()||Y()||ie();o()||o(i?"rollerskate":"skateboard")});function We(){return T().length<5}function rt(){We()&&T([...T(),{name:"",value:.5}])}async function it(i){i.preventDefault();const I={name:p(),build_type:o(),skater_type:F(),skating_type:h(),deck_id:o()==="skateboard"&&u()||void 0,griptape_id:o()==="skateboard"&&E()||void 0,rails_id:o()==="skateboard"&&J()||void 0,risers_id:o()==="skateboard"&&Z()||void 0,boot_id:o()==="rollerskate"&&q()||void 0,toestops_id:o()==="rollerskate"&&ne()||void 0,slideblock_id:o()==="rollerskate"&&oe()||void 0,plates_id:o()==="rollerskate"&&s()||void 0,trucks_id:S()||void 0,bearings_id:C()||void 0,wheels_id:W()||void 0,bushings_id:K()||void 0,...T().length?{attributes:T()}:{}};await te()({detail:I})}Le();var me=va(),ye=f(me),Ue=l(f(ye),2);ge(Ue),v(ye);var he=l(ye,2);Ae(he,5,()=>lt,Xe,(i,I)=>{var d=sa(),y=f(d);ge(y);var b,x=l(y);v(d),_e(w=>{b!==(b=a(I))&&(y.value=(y.__value=a(I))??""),et(x,` ${w??""}`)},[()=>a(I).charAt(0).toUpperCase()+a(I).slice(1)],Ve),It(g,[],y,()=>(a(I),o()),o),L(i,d)}),v(he);var ke=l(he,2),Se=l(f(ke),2);_e(()=>{h(),bt(()=>{o()})});var Ie=f(Se);Ie.value=Ie.__value="";var st=l(Ie);{var nt=i=>{var I=na(),d=fe(I);d.value=d.__value="street";var y=l(d,2);y.value=y.__value="vert";var b=l(y,2);b.value=b.__value="freestyle";var x=l(b,2);x.value=x.__value="park";var w=l(x,2);w.value=w.__value="downhill";var R=l(w,2);R.value=R.__value="cruisin",L(i,I)},ot=i=>{var I=oa(),d=fe(I);d.value=d.__value="artistic skating";var y=l(d,2);y.value=y.__value="roller dance";var b=l(y,2);b.value=b.__value="speed skating";var x=l(b,2);x.value=x.__value="roller derby";var w=l(x,2);w.value=w.__value="park skating";var R=l(w,2);R.value=R.__value="roller hockey",L(i,I)};se(st,i=>{o()==="skateboard"?i(nt):i(ot,!1)})}v(Se),v(ke);var ze=l(ke,2);{var ut=i=>{var I=ua(),d=fe(I),y=l(f(d),2);z(y,{category:"skateboard",type:"decks",get initialName(){return _()},placeholder:"Choose a deck…",get value(){return re()},set value(n){re(n)},get valueId(){return u()},set valueId(n){u(n)},$$legacy:!0}),v(d);var b=l(d,2),x=l(f(b),2);z(x,{category:"skateboard",type:"griptape",get initialName(){return m()},placeholder:"Choose griptape…",get value(){return U()},set value(n){U(n)},get valueId(){return E()},set valueId(n){E(n)},$$legacy:!0}),v(b);var w=l(b,2),R=l(f(w),2);z(R,{category:"skateboard",type:"rails",get initialName(){return M()},placeholder:"Choose rails…",get value(){return B()},set value(n){B(n)},get valueId(){return J()},set valueId(n){J(n)},$$legacy:!0}),v(w);var ae=l(w,2),Oe=l(f(ae),2);z(Oe,{category:"skateboard",type:"risers",get initialName(){return A()},placeholder:"Choose risers…",get value(){return V()},set value(n){V(n)},get valueId(){return Z()},set valueId(n){Z(n)},$$legacy:!0}),v(ae),L(i,I)};se(ze,i=>{o()==="skateboard"&&i(ut)})}var Ge=l(ze,2);{var dt=i=>{var I=da(),d=fe(I),y=l(f(d),2);z(y,{category:"rollerskate",type:"boots",get initialName(){return k()},placeholder:"Choose boot…",get value(){return X()},set value(n){X(n)},get valueId(){return q()},set valueId(n){q(n)},$$legacy:!0}),v(d);var b=l(d,2),x=l(f(b),2);z(x,{category:"rollerskate",type:"toestops",get initialName(){return N()},placeholder:"Choose toestops…",get value(){return ue()},set value(n){ue(n)},get valueId(){return ne()},set valueId(n){ne(n)},$$legacy:!0}),v(b);var w=l(b,2),R=l(f(w),2);z(R,{category:"rollerskate",type:"slideblocks",get initialName(){return P()},placeholder:"Choose slideblocks…",get value(){return Y()},set value(n){Y(n)},get valueId(){return oe()},set valueId(n){oe(n)},$$legacy:!0}),v(w);var ae=l(w,2),Oe=l(f(ae),2);z(Oe,{category:"rollerskate",type:"plates",get initialName(){return G()},placeholder:"Choose plates…",get value(){return ie()},set value(n){ie(n)},get valueId(){return s()},set valueId(n){s(n)},$$legacy:!0}),v(ae),L(i,I)};se(Ge,i=>{o()==="rollerskate"&&i(dt)})}var we=l(Ge,2),ct=l(f(we),2);z(ct,{get category(){return o()},type:"trucks",get initialName(){return H()},placeholder:"Choose trucks…",get value(){return de()},set value(i){de(i)},get valueId(){return S()},set valueId(i){S(i)},$$legacy:!0}),v(we);var Te=l(we,2),vt=l(f(Te),2);z(vt,{get category(){return o()},type:"bearings",get initialName(){return O()},placeholder:"Choose bearings…",get value(){return Fe()},set value(i){Fe(i)},get valueId(){return C()},set valueId(i){C(i)},$$legacy:!0}),v(Te);var xe=l(Te,2),ft=l(f(xe),2);z(ft,{get category(){return o()},type:"wheels",get initialName(){return Q()},placeholder:"Choose wheels…",get value(){return Me()},set value(i){Me(i)},get valueId(){return W()},set valueId(i){W(i)},$$legacy:!0}),v(xe);var Ne=l(xe,2),gt=l(f(Ne),2);z(gt,{get category(){return o()},type:"bushings",get initialName(){return le()},placeholder:"Choose bushings…",get value(){return qe()},set value(i){qe(i)},get valueId(){return K()},set valueId(i){K(i)},$$legacy:!0}),v(Ne);var He=l(Ne,2),Je=l(f(He),2);Ae(Je,1,T,Xe,(i,I,d)=>{var y=ca(),b=f(y);ge(b);var x=l(b,2);ge(x);var w=l(x,2);v(y),pe(b,()=>T()[d].name,R=>T(T()[d].name=R,!0)),pe(x,()=>T()[d].value,R=>T(T()[d].value=R,!0)),ee("click",w,()=>T(T().filter((R,ae)=>ae!==d))),L(i,y)});var Ke=l(Je,2);v(He),pt(2),v(me),_e(i=>Ke.disabled=i,[()=>!We()],Ve),pe(Ue,p),wt(Se,h),ee("click",Ke,rt),ee("submit",me,it),L(t,me),Re()}var ga=D('<meta name="description" content="Start building your own skateboard or rollerskates.">'),_a=D('<h1>Create a New Build</h1> <div class="container"><!></div>',1);function Ea(t,e){Ee(e,!1);let g=$({});De(()=>{Ye.subscribe(_=>{c(g,_||{})})});async function p(_){const m=_.detail,{token:A}=kt(Tt),M=await fetch("https://3ee.dev/skatebuild/api/builds/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"https://skatebuild.pro",Authorization:"Token "+A},mode:"cors",body:JSON.stringify(m)});if(M.ok){const k=await M.json();Ye.set(k),await xt(`/builds/${k.owner}/${k.slug}`)}else console.error("Save failed",await M.json())}Le();var j=_a();_t(_=>{var m=ga();jt.title="Build your own Skateboard or Rollerskate",L(_,m)});var F=l(fe(j),2),h=f(F);fa(h,yt(()=>a(g),{submit:p})),v(F),L(t,j),Re()}export{Ea as component,Pa as universal};
